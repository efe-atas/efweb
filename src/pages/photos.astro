---
import Layout from '~/layouts/Layout.astro'

// Fotoğraf verileri - daha sonra kendi fotoğraflarınızla değiştirebilirsiniz
const photos = [
  {
    src: '/photos/IMG_0071.jpeg',
    title: 'Dağlar',
    location: 'Simav, Kütahya',
    year: '2024',
    aspectRatio: 'portrait'
  },
  {
    src: '/photos/IMG_0863.jpeg',
    title: 'Bahçe',
    location: 'Akyurt, Ankara',
    year: '2023',
    aspectRatio: 'landscape'
  },
  {
    src: '/photos/IMG_1016.jpeg',
    title: 'Ted University',
    location: 'Ankara, Turkey',
    year: '2024',
    aspectRatio: 'landscape'
  },
  {
    src: '/photos/IMG_2114.jpeg',
    title: 'Güneşin Batışı',
    location: 'Simav, Kütahya',
    year: '2024',
    aspectRatio: 'landscape'
  },
  {
    src: '/photos/IMG_8824.jpeg',
    title: 'Koyunlar',
    location: 'Trabzon, Turkey',
    year: '2019',
    aspectRatio: 'landscape'
  },
  {
    src: '/photos/IMG_8834.jpeg',
    title: 'Yol',
    location: 'Trabzon, Turkey',
    year: '2019',
    aspectRatio: 'landscape'
  },
]
---

<Layout title="Photos" description="A curated collection of photographs by İsmail Efe Ataş">
  <div class="py-7.5">
    <!-- Header -->
    <header class="mb-12 md:mx-2">
      <h1 class="text-[1.75rem] text-heading1 font-semibold mb-4">
        # Photos
      </h1>
      <p class="text-foreground/70 text-base leading-relaxed max-w-xl">
        
      </p>
    </header>

    <!-- Gallery Grid -->
    <div class="gallery-container">
      {photos.map((photo, index) => (
        <figure 
          class="gallery-item group"
          data-index={index}
          data-src={photo.src}
          data-title={photo.title}
          data-location={photo.location}
          data-year={photo.year}
        >
          <div class="relative overflow-hidden rounded-lg">
            <img 
              src={photo.src} 
              alt={photo.title}
              class="gallery-image"
              loading="lazy"
            />
            <!-- Hover Overlay -->
            <div class="absolute inset-0 bg-background/80 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end justify-start p-4">
              <div class="text-foreground">
                <h3 class="text-lg font-semibold text-heading2">{photo.title}</h3>
                <p class="text-sm text-foreground/60">{photo.location} · {photo.year}</p>
              </div>
            </div>
          </div>
        </figure>
      ))}
    </div>

    <!-- Lightbox -->
    <div id="lightbox" class="lightbox">
      <button id="lightbox-close" class="lightbox-close" aria-label="Kapat">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
      <button id="lightbox-prev" class="lightbox-nav lightbox-prev" aria-label="Önceki">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>
      <button id="lightbox-next" class="lightbox-nav lightbox-next" aria-label="Sonraki">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>
      <div class="lightbox-content">
        <img id="lightbox-image" src="" alt="" />
        <div id="lightbox-caption" class="lightbox-caption"></div>
      </div>
    </div>

    <!-- Footer Note -->
    <div class="mt-16 md:mx-2 text-center">
      <p class="text-foreground/50 text-sm italic">
        "Everyone dies alone. But if you mean something to someone, if you help someone, or love someone. If even a single person remembers you. Then maybe, you never really die at all."
      </p>
    </div>
  </div>
</Layout>

<style>
  .gallery-container {
    display: grid;
    grid-template-columns: repeat(1, 1fr);
    gap: 1.5rem;
  }

  @media (min-width: 640px) {
    .gallery-container {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 1024px) {
    .gallery-container {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  .gallery-item {
    margin: 0;
    cursor: pointer;
  }

  .gallery-image {
    width: 100%;
    height: auto;
    aspect-ratio: 4/3;
    object-fit: cover;
    transition: transform 0.5s ease, filter 0.3s ease;
    filter: grayscale(20%);
  }

  .gallery-item:hover .gallery-image {
    transform: scale(1.02);
    filter: grayscale(0%);
  }

  /* Lightbox Styles */
  .lightbox {
    position: fixed;
    inset: 0;
    background: var(--theme-background);
    z-index: 100;
    display: none;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .lightbox.active {
    display: flex;
    opacity: 1;
  }

  .lightbox-close {
    position: absolute;
    top: 1.5rem;
    right: 1.5rem;
    color: var(--theme-foreground);
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 0.5rem;
    opacity: 0.7;
    transition: opacity 0.2s ease;
    z-index: 101;
  }

  .lightbox-close:hover {
    opacity: 1;
  }

  .lightbox-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    color: var(--theme-foreground);
    background: var(--theme-background);
    border: 1px solid color-mix(in srgb, var(--theme-foreground), 20%, transparent);
    border-radius: 50%;
    cursor: pointer;
    padding: 0.75rem;
    opacity: 0.7;
    transition: opacity 0.2s ease, background 0.2s ease;
    z-index: 101;
  }

  .lightbox-nav:hover {
    opacity: 1;
    background: color-mix(in srgb, var(--theme-accent), 10%, transparent);
  }

  .lightbox-prev {
    left: 1.5rem;
  }

  .lightbox-next {
    right: 1.5rem;
  }

  .lightbox-content {
    max-width: 90vw;
    max-height: 85vh;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .lightbox-content img {
    max-width: 100%;
    max-height: 75vh;
    object-fit: contain;
    border-radius: 0.5rem;
  }

  .lightbox-caption {
    margin-top: 1rem;
    text-align: center;
    color: var(--theme-foreground);
    opacity: 0.8;
  }

  .lightbox-caption h3 {
    font-size: 1.125rem;
    font-weight: 600;
    margin-bottom: 0.25rem;
  }

  .lightbox-caption p {
    font-size: 0.875rem;
    opacity: 0.6;
  }
</style>

<script>
  // Fotoğraf verilerini DOM'dan oku
  const galleryItems = document.querySelectorAll('.gallery-item')
  const photos: { src: string; title: string; location: string; year: string }[] = []
  
  galleryItems.forEach((item) => {
    photos.push({
      src: item.getAttribute('data-src') || '',
      title: item.getAttribute('data-title') || '',
      location: item.getAttribute('data-location') || '',
      year: item.getAttribute('data-year') || ''
    })
  })

  let currentIndex = 0
  const lightbox = document.getElementById('lightbox')
  const lightboxImage = document.getElementById('lightbox-image') as HTMLImageElement
  const lightboxCaption = document.getElementById('lightbox-caption')
  const closeBtn = document.getElementById('lightbox-close')
  const prevBtn = document.getElementById('lightbox-prev')
  const nextBtn = document.getElementById('lightbox-next')

  function openLightbox(index: number) {
    currentIndex = index
    updateLightbox()
    lightbox?.classList.add('active')
    document.body.style.overflow = 'hidden'
  }

  function closeLightbox() {
    lightbox?.classList.remove('active')
    document.body.style.overflow = ''
  }

  function updateLightbox() {
    const photo = photos[currentIndex]
    if (lightboxImage && photo) {
      lightboxImage.src = photo.src
      lightboxImage.alt = photo.title
    }
    if (lightboxCaption && photo) {
      lightboxCaption.innerHTML = `
        <h3>${photo.title}</h3>
        <p>${photo.location} · ${photo.year}</p>
      `
    }
  }

  function nextPhoto() {
    currentIndex = (currentIndex + 1) % photos.length
    updateLightbox()
  }

  function prevPhoto() {
    currentIndex = (currentIndex - 1 + photos.length) % photos.length
    updateLightbox()
  }

  // Event listeners
  galleryItems.forEach((item) => {
    item.addEventListener('click', () => {
      const index = parseInt(item.getAttribute('data-index') || '0')
      openLightbox(index)
    })
  })

  closeBtn?.addEventListener('click', closeLightbox)
  nextBtn?.addEventListener('click', nextPhoto)
  prevBtn?.addEventListener('click', prevPhoto)

  // Keyboard navigation
  document.addEventListener('keydown', (e) => {
    if (!lightbox?.classList.contains('active')) return
    
    if (e.key === 'Escape') closeLightbox()
    if (e.key === 'ArrowRight') nextPhoto()
    if (e.key === 'ArrowLeft') prevPhoto()
  })

  // Close on background click
  lightbox?.addEventListener('click', (e) => {
    if (e.target === lightbox) closeLightbox()
  })
</script>
